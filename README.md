# ants
Automated Network Testing System 

## В работе
![image-2023-2-10_12-55-4](https://github.com/meoree/ants/assets/31919838/36285b4d-d9f7-4efd-8a34-bb34d314ae85)

**1. CI/CD система**

Это система, которая занимается управлением тестами, сетевым менеджером и менеджером ресурсов.

Задачи: 
1) Скачивает версии ПО для перепрошивки приборов
2) Выбирает тесты для запуска, автоматические или ручные в зависимости от входа
3) Выбирает устройства, которые нужны для запуска тестов. Для этого обращается к менеджеру ресурсов
4) Менеджер ресурсов передает системе доступные устройства, их подключение, VLAN и IP-адрес для устройства
5) Система перепрошивает устройства (оставляя сетевые настройки), выбранные в п.4 
6) После перепрошивки система передает сетевому менеджеру для настройки данные устройств от менеджера ресурсов
7) Передает тесту/сценарию данные от менеджера ресурсов
8) Запускает выполнение теста/сценария тестирования
9) Контролирует ход выполнения тестирования, ведет лог
10) Формирует общий отчет по тестированию
11) После окончания теста вызывает сетевого менеджера, который должен сбросить настройки коммутаторов, сетевые настройки устройств в дефолт. Вызывает менеджера ресурсов, который должен освободить устройства.
    
Даже если тест в процессе был прерван, то по истечению определенного времени будет вызван сетевой менеджер и менеджер ресурсов.

На вход:
1) Информация о версии ПО:
a) Откуда скачать эту версию
b) Для какого прибора версия
c) Beta или релизная версия
d) Какая версия ПО (с каким набором тестов)
 
2) Как будет проводится тест:
a) Автоматически или вручную
Пример для автоматического запуска сценариев тестов: на вход системе поступает релизное ПО для М720; в системе определен набор тестов для релизных версий ПО; система обновит все необходимые М720 и запустит набор разных тестов (последовательно или паралелльно).
Вручную сами задаем список тестов.


На выходе:

Итоговый отчет о тестировании

**2. Тест**

Скрипт, который запускает CI/CD система. Тесты не привязаны к какому-то конкретному железу, IP-адресам и VLAN.

Задачи:
1) Подключается к оборудованию и настраивает на нем параметры теста, например erspan
2) Запускает сервисы
3) Останавливает сервисы
4) Стирает параметры тестов (напр. vlan на ЕТ в параметрах теста)
5) Формирует отчет

   
На вход:

Менеджер ресурсов передает данные об устройствах, на которых будет выпоняться тест, их VLAN, IP-адреса

На выходе:

Отчет о тестировании

**3. Репозиторий**

Хранилище.
Задачи:
1) Контроль версий
2) Хранений конфигов, кода, шаблонов, тестов

**4. Менеджер ресурсов**

Файл(ы) с данными об устройствах в стенде. Выбирает устройства, которые будут учавствовать в тесте по определенным параметрам. 

Задачи:
1) Выбирает устройства для теста: доступные (свободные) и подходящие по параметрам
2) Отмечает выбранные устройства занятыми
3) Передает информацию о выбранных устройствах CI/CD системе 
4) Снимает занятость по требованию CI/CD системы после окончания тестов
   
На вход:

Устройства, которые нужны для теста

На выход:

Выбранные устройства и вся информация о них

**5. Сетевой менеджер**

Настраивает связность L2, L3 между устройствами, которые выдал для теста менеджер ресурсов. Удаляет связность после окончания теста по требованию CI/CD системы.

Задачи:
1) настраивает подинтерфейсы устройств
2) настраивает L2 и L3 связность между устройствами
3) удаляет сделанные сетевые настройки на устройствах
   
На вход:

Менеджер ресурсов передает данные об устройствах, на которых будет выпоняться тест, их VLAN, IP-адреса
